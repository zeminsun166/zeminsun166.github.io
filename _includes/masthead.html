<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links" id="navigation-links">
          <!-- å¯¼èˆªé“¾æ¥å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </ul>
        <ul class="hidden-links hidden" id="mobile-navigation-links">
          <!-- ç§»åŠ¨ç«¯å¯¼èˆªé“¾æ¥å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          <li class="language-switcher">
            <button id="lang-toggle" class="lang-toggle-btn" title="åˆ‡æ¢è¯­è¨€/Switch Language">
              <span class="lang-text-mobile" data-show-when="zh">English</span>
              <span class="lang-text-mobile" data-show-when="en">ä¸­æ–‡</span>
            </button>
          </li>
        </ul>
      </nav>
    </div>
    <!-- æ¡Œé¢ç«¯ç‹¬ç«‹çš„è¯­è¨€åˆ‡æ¢å™¨ -->
    <div class="language-switcher language-switcher--desktop">
      <button id="lang-toggle-desktop" class="lang-toggle-btn" title="åˆ‡æ¢è¯­è¨€/Switch Language">
        ğŸŒ
      </button>
    </div>
  </div>
</div>

<script>
// å¯¼èˆªæ•°æ®
const navigationData = {
  zh: [
    { title: "ä¸»é¡µ", section: "about-me" },
    { title: "æ•™è‚²ç»å†", section: "educations" },
    { title: "å­¦æœ¯è®ºæ–‡", section: "publications" },
    { title: "é¡¹ç›®ç»å†", section: "projects" },
    { title: "ä¸“åˆ©", section: "patents" },
    { title: "å­¦æœ¯æœåŠ¡", section: "services" },
    { title: "è·å¥–æƒ…å†µ", section: "awards" }
  ],
  en: [
    { title: "Homepage", section: "about-me" },
    { title: "Education", section: "educations" },
    { title: "Publications", section: "publications" },
    { title: "Projects", section: "projects" },
    { title: "Patents", section: "patents" },
    { title: "Services", section: "services" },
    { title: "Awards", section: "awards" }
  ]
};

// è·å–å½“å‰è¯­è¨€
function getCurrentLanguage() {
  const currentPath = window.location.pathname;
  return (currentPath.includes('/en/')) ? 'en' : 'zh';
}

// ç”Ÿæˆå¯¼èˆªé“¾æ¥
function generateNavigationLinks() {
  const currentLang = getCurrentLanguage();
  const navData = navigationData[currentLang];
  const navContainer = document.getElementById('navigation-links');
  const mobileNavContainer = document.getElementById('mobile-navigation-links');
  
  if (!navContainer || !navData) return;
  
  // æ¸…ç©ºç°æœ‰é“¾æ¥
  navContainer.innerHTML = '';
  
  // ç”Ÿæˆæ¡Œé¢ç«¯å¯¼èˆªé“¾æ¥
  navData.forEach((item, index) => {
    const li = document.createElement('li');
    const a = document.createElement('a');
    
    // è®¾ç½®é“¾æ¥å±æ€§ - æ ¹æ®å½“å‰è¯­è¨€è®¾ç½®æ­£ç¡®çš„é“¾æ¥
    if (currentLang === 'en') {
      // è‹±æ–‡ç‰ˆæœ¬ï¼šé“¾æ¥åˆ°è‹±æ–‡é¡µé¢çš„ç›¸åº”éƒ¨åˆ†
      a.href = `/en/about/#${item.section}`;
    } else {
      // ä¸­æ–‡ç‰ˆæœ¬ï¼šé“¾æ¥åˆ°ä¸­æ–‡é¡µé¢çš„ç›¸åº”éƒ¨åˆ†
      a.href = `/about/#${item.section}`;
    }
    
    a.textContent = item.title;
    a.className = 'nav-link';
    a.dataset.section = item.section;
    
    // ç¬¬ä¸€ä¸ªé“¾æ¥æ˜¯ä¸»é¡µï¼Œéœ€è¦ç‰¹æ®Šæ ·å¼
    if (index === 0) {
      li.className = 'masthead__menu-item masthead__menu-item--lg masthead__menu-home-item';
    } else {
      li.className = 'masthead__menu-item';
    }
    
    li.appendChild(a);
    navContainer.appendChild(li);
  });

  // ç”Ÿæˆç§»åŠ¨ç«¯å¯¼èˆªé“¾æ¥
  if (mobileNavContainer) {
    // ä¿å­˜è¯­è¨€åˆ‡æ¢å™¨
    const languageSwitcher = mobileNavContainer.querySelector('.language-switcher');
    
    // æ¸…ç©ºç§»åŠ¨ç«¯å¯¼èˆªï¼Œä½†ä¿ç•™è¯­è¨€åˆ‡æ¢å™¨
    mobileNavContainer.innerHTML = '';
    
    // é‡æ–°æ·»åŠ å¯¼èˆªé“¾æ¥
    navData.forEach((item) => {
      const li = document.createElement('li');
      const a = document.createElement('a');
      
      // è®¾ç½®é“¾æ¥å±æ€§ - æ ¹æ®å½“å‰è¯­è¨€è®¾ç½®æ­£ç¡®çš„é“¾æ¥
      if (currentLang === 'en') {
        // è‹±æ–‡ç‰ˆæœ¬ï¼šé“¾æ¥åˆ°è‹±æ–‡é¡µé¢çš„ç›¸åº”éƒ¨åˆ†
        a.href = `/en/about/#${item.section}`;
      } else {
        // ä¸­æ–‡ç‰ˆæœ¬ï¼šé“¾æ¥åˆ°ä¸­æ–‡é¡µé¢çš„ç›¸åº”éƒ¨åˆ†
        a.href = `/about/#${item.section}`;
      }
      
      a.textContent = item.title;
      a.className = 'nav-link-mobile';
      a.dataset.section = item.section;
      
      li.appendChild(a);
      mobileNavContainer.appendChild(li);
    });
    
    // é‡æ–°æ·»åŠ è¯­è¨€åˆ‡æ¢å™¨åˆ°æœ€å
    if (languageSwitcher) {
      mobileNavContainer.appendChild(languageSwitcher);
    }
  }
}

// æ›´æ–°å¯¼èˆªé“¾æ¥
function updateNavigationLinks() {
  generateNavigationLinks();
}

// é¡µé¢åŠ è½½å®Œæˆåç”Ÿæˆå¯¼èˆªé“¾æ¥
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(() => {
    generateNavigationLinks();
  }, 100);
});

// è¯­è¨€åˆ‡æ¢åæ›´æ–°å¯¼èˆªé“¾æ¥
document.addEventListener('languageChanged', function() {
  generateNavigationLinks();
});
</script>